---
title: "Paper 1"
author: "Emily Panus, 1006142915"
date: "06/02/2022"
output: pdf_document
abstract: "Homelessness in Toronto is measured to display the proportion of the population experiencing the unfortunate troubles of being displaced, especially during the pandemic that is difficult for cities to solve. Measuring shelter flow is an efficient way for Toronto to assess the functionality and livability of the system to then assist in improving and reducing its numbers in the future. The shelter flow is calculated on a monthly basis to calculate the people entering, returning, and leaving in all different population groups and ages that we graphed to evaluate the recent homeless situation in Toronto.  It is clear to see that the majority of people experiencing homelessness are of gender male and aged from 24 to 44, active homelessness increases in winter months and the inflow and outflow of people in shelters have similar movement throughout the months. These findings show that recently, notably the devastating increase in homeless during Covid-19, there are many vulnerable people out on the streets, which can use benefit from government, financial and shelter services assistance."
---

\tableofcontents

\listoffigures

\newpage
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1 Introduction 


## 2 Data 

### 2.1 Data Source 

In this report, the data regarding the shelter flow of homeless in Toronto is obtained from Shelter System Flow Data (). The data details the number of people entering, returning, and leaving shelters and offered services in the last three months and that are not discharged to permanent housing. The data is attained by the Shelter Management Information System (SMIS), which registers distinctive homeless people that have stayed at any shelters, respites, motel programs, and other services in the last three months and that are not discharged to permanent housing. The reported homeless and shelter flow system dataset used was obtained in csv format from the City of Toronto Open Data Portal using the R package opendatatoronto () and was last updated on January 7th, 2020.

### 2.2 Methodology and Data Collection

### 2.3 Data Characteristics 

#### 2.3.1
#### 2.3.2
#### 2.3.3
#### 2.3.4

```{r, include=FALSE}
library(opendatatoronto)
library(tidyverse)
library(janitor)
```

```{r, include = FALSE}
search_packages("Shelter")
```

```{r, include=FALSE}
search_packages("Shelter")[4, ]
```

```{r, include=FALSE}
idoftheonewewant <- search_packages(" Shelter")[4,'id']
idoftheonewewant <- pull(idoftheonewewant,id)
idoftheonewewant
```

```{r, include=FALSE}
list_package_resources(idoftheonewewant)
```

```{r, include=FALSE}
idofthedata <- pull(
  list_package_resources(idoftheonewewant)[1,"id"],
  id
)
idofthedata
```

```{r, include=FALSE}
homeless_flow_data <- get_resource(idofthedata)
homeless_flow_data <- janitor::clean_names(homeless_flow_data)
sum(is.na(homeless_flow_data))
```

```{r, echo=FALSE}
data_flow_table <- tibble(homeless_flow_data[1:7, c(3:9,11:13,15:16)])

knitr::kable(data_flow_table, col.names = c("Population Group", "Returned from housing", 	"Returned to shelter",	"Newly identified",	"Moved to housing",	"No recent shelter use",	"Actively homeless",	"Age 16-24",	"Age 25-44",	"Age 45-64",	"Gender male",	"Gender female"))
```


```{r, echo=FALSE}
x1 <- homeless_flow_data %>% 
  select(population_group, ageunder16, age16_24, age25_44, age45_64, age65over) %>% 
  group_by(population_group) %>% 
  summarize(ageunder16=sum(ageunder16), age16_24=sum(age16_24),
            age25_44=sum(age25_44), age45_64=sum(age45_64), age65over=sum(age65over))

data_ggp_pop_group <- data.frame(x = x1$population_group,                          
                       y = c(x1$ageunder16, x1$age16_24, x1$age25_44, 
                             x1$age45_64, x1$age65over),
                       age_group = c(rep("ageunder16", nrow(x1)),
                                 rep("age16_24", nrow(x1)),
                                 rep("age25_44", nrow(x1)),
                                 rep("age45_64", nrow(x1)),
                                 rep("age65over", nrow(x1))))

ggp_pop_group <- ggplot(data_ggp_pop_group, aes(x, y, fill = age_group)) +             
  geom_col(position='dodge') +
  ggtitle("Flow in Shelters of Age Groups in each Population Group")+
  xlab("Population Groups")+
  ylab("Count")+
  theme(axis.text.x=element_text(angle=90,hjust=1))
ggp_pop_group 

```
```{r, include=FALSE}
class(homeless_flow_data$date_mmm_yy)
da <- homeless_flow_data$date_mmm_yy
homeless_flow_data$dates <- as.Date(paste("01-", da, sep = ""), format = "%d-%b-%y")
```

```{r}
all_pop_data <- subset(homeless_flow_data, population_group == "All Population")
all_pop_data
```

```{r, echo=FALSE}
a <- sum(all_pop_data$gender_male)/sum(all_pop_data$gender_male, all_pop_data$gender_female, all_pop_data$gender_transgender_non_binary_or_two_spirit)

b <- sum(all_pop_data$gender_female)/sum(all_pop_data$gender_male, all_pop_data$gender_female, all_pop_data$gender_transgender_non_binary_or_two_spirit)

c <- sum(all_pop_data$gender_transgender_non_binary_or_two_spirit)/sum(all_pop_data$gender_male, all_pop_data$gender_female, all_pop_data$gender_transgender_non_binary_or_two_spirit)

gender_data <-tibble(male=a, female=b, "transgender or non binary"=c)

gender_data <-as.data.frame(t(gender_data))
gender_data <- rownames_to_column(gender_data, var="gender")

ggplot(gender_data, aes(x=gender, y=V1))+
  geom_bar(stat = "identity", position = "dodge", fill="navyblue") +
  ggtitle("Proportion of Homelessness of each Gender") + 
  xlab("Genders")+
  ylab("Proportion")
```


```{r, echo=FALSE}
act_homeless <- all_pop_data %>% 
  group_by(dates) %>% 
  summarise(mean=mean(actively_homeless)) %>% 
  ungroup()

ggplot(act_homeless, aes(x=dates, y=mean)) +
  geom_point()+
  geom_line()+
  xlab("Time in Months")+
  ylab("Number of People")+
  ggtitle("Number of people Actively Homeless in each Month")
  
```

```{r, echo=FALSE}
#Outflow data includes moved to permanent housing and no recent shelter usage
all_pop_data$outflow <- all_pop_data$moved_to_housing + all_pop_data$no_recent_shelter_use


outflow_data <- all_pop_data %>% 
  group_by(dates) %>% 
  summarise(mean_outflow=mean(outflow))



#Inflow data includes moved to permanent housing and no recent shelter usage
all_pop_data$inflow <- all_pop_data$newly_identified + all_pop_data$returned_from_housing + all_pop_data$returned_to_shelter

inflow_data <- all_pop_data %>% 
  group_by(dates) %>% 
  summarise(mean_inflow=mean(inflow))


# line graph 
inflow_outflow <- merge(inflow_data, outflow_data, by="dates")
inflow_outflow

ggplot(inflow_outflow, aes(x=dates))+
  geom_line(aes(y = mean_inflow), color = "red") + 
  geom_line(aes(y = mean_outflow), color="darkblue")+
  xlab("Time in Months")+
  ylab("Number of People")+
  ggtitle("Inflow and Outflow of People in Shelters per Month")
```


## Refrences